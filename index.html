<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeadMap ‚Äî Demo</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Exo+2:wght@300;400;600;800;900&display=swap" rel="stylesheet">
<style>
  :root {
    --green: #39FF14;
    --green-dim: #1a7a0a;
    --red: #FF2D2D;
    --yellow: #FFD600;
    --bg: #080c08;
    --panel: #0d120d;
    --border: #1a2e1a;
    --text: #c8e6c8;
    --muted: #4a6a4a;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    font-family: 'Exo 2', sans-serif;
    color: var(--text);
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  /* ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ */
  .topbar {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 16px;
    background: #050905;
    border-bottom: 1px solid var(--border);
    z-index: 100;
    flex-shrink: 0;
  }
  .logo {
    font-family: 'Share Tech Mono', monospace;
    font-size: 1.2rem;
    color: var(--green);
    letter-spacing: 3px;
    text-shadow: 0 0 10px var(--green);
    flex-shrink: 0;
  }
  .search-bar {
    flex: 1;
    display: flex;
    align-items: center;
    background: #0d180d;
    border: 1px solid var(--green-dim);
    border-radius: 4px;
    padding: 6px 12px;
    gap: 8px;
    transition: border-color 0.2s;
    max-width: 420px;
  }
  .search-bar:focus-within { border-color: var(--green); box-shadow: 0 0 8px #39ff1433; }
  .search-bar input {
    background: none;
    border: none;
    outline: none;
    color: var(--green);
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.82rem;
    width: 100%;
  }
  .search-bar input::placeholder { color: var(--muted); }
  .search-icon { color: var(--muted); font-size: 0.9rem; }
  .search-btn {
    background: var(--green);
    color: #000;
    border: none;
    border-radius: 3px;
    padding: 5px 12px;
    font-family: 'Exo 2', sans-serif;
    font-weight: 800;
    font-size: 0.75rem;
    cursor: pointer;
    letter-spacing: 1px;
    transition: opacity 0.2s;
    flex-shrink: 0;
  }
  .search-btn:hover { opacity: 0.85; }

  .status-pills { display: flex; gap: 8px; margin-left: auto; flex-shrink: 0; }
  .pill {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    padding: 3px 8px;
    border-radius: 20px;
    letter-spacing: 1px;
  }
  .pill-mesh { background: #0d2e0d; color: var(--green); border: 1px solid var(--green-dim); }
  .pill-users { background: #0d200d; color: #7fff7f; border: 1px solid #2a4a2a; }

  /* ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ */
  .main {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  /* ‚îÄ‚îÄ MAP ‚îÄ‚îÄ */
  .map-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    background: #060e06;
  }

  /* Grid de mapa estilo militar */
  .map-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(57,255,20,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(57,255,20,0.04) 1px, transparent 1px);
    background-size: 40px 40px;
  }
  .map-grid-big {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(57,255,20,0.08) 1px, transparent 1px),
      linear-gradient(90deg, rgba(57,255,20,0.08) 1px, transparent 1px);
    background-size: 200px 200px;
  }

  /* Calles */
  .street {
    position: absolute;
    background: #0f1f0f;
    border: 1px solid #1a2e1a;
  }
  .street-h { height: 18px; left: 0; right: 0; }
  .street-v { width: 18px; top: 0; bottom: 0; }

  /* Zonas de color */
  .zone {
    position: absolute;
    border-radius: 6px;
    cursor: pointer;
    transition: opacity 0.3s, transform 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    font-weight: bold;
    letter-spacing: 1px;
    border: 1px solid;
  }
  .zone:hover { transform: scale(1.03); }
  .zone-red    { background: rgba(255,45,45,0.18); border-color: rgba(255,45,45,0.5); color: #ff7070; }
  .zone-yellow { background: rgba(255,214,0,0.12); border-color: rgba(255,214,0,0.4); color: #ffd600; }
  .zone-green  { background: rgba(57,255,20,0.10); border-color: rgba(57,255,20,0.35); color: var(--green); }

  /* Ruta de escape */
  .route-svg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
  .route-path {
    fill: none;
    stroke: var(--green);
    stroke-width: 3;
    stroke-dasharray: 10 6;
    stroke-linecap: round;
    animation: dash 1s linear infinite;
    filter: drop-shadow(0 0 4px var(--green));
    opacity: 0;
    transition: opacity 0.5s;
  }
  .route-path.visible { opacity: 1; }
  @keyframes dash { to { stroke-dashoffset: -32; } }

  /* Marcador usuario */
  .marker-user {
    position: absolute;
    width: 16px; height: 16px;
    background: var(--green);
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0 0 0 4px rgba(57,255,20,0.25), 0 0 16px var(--green);
    transform: translate(-50%, -50%);
    z-index: 10;
    animation: pulse-user 2s infinite;
  }
  @keyframes pulse-user {
    0%,100% { box-shadow: 0 0 0 4px rgba(57,255,20,0.25), 0 0 16px var(--green); }
    50%      { box-shadow: 0 0 0 8px rgba(57,255,20,0.1),  0 0 24px var(--green); }
  }

  /* Marcadores de zombis */
  .marker-zombie {
    position: absolute;
    transform: translate(-50%, -50%);
    z-index: 9;
    cursor: pointer;
  }
  .zombie-dot {
    width: 12px; height: 12px;
    background: var(--red);
    border-radius: 50%;
    border: 1px solid #ff6060;
    box-shadow: 0 0 8px var(--red);
    animation: pulse-zombie 1.5s infinite;
    position: relative;
  }
  .zombie-arrow {
    position: absolute;
    font-size: 0.7rem;
    color: var(--red);
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    text-shadow: 0 0 6px var(--red);
  }
  @keyframes pulse-zombie {
    0%,100% { transform: scale(1); opacity: 1; }
    50%      { transform: scale(1.3); opacity: 0.8; }
  }

  /* Marcadores de refugio */
  .marker-shelter {
    position: absolute;
    transform: translate(-50%, -50%);
    z-index: 9;
    cursor: pointer;
  }
  .shelter-icon {
    width: 22px; height: 22px;
    background: #0d2e0d;
    border: 2px solid var(--green);
    border-radius: 4px;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem;
    box-shadow: 0 0 10px rgba(57,255,20,0.3);
  }

  /* Marcadores de recursos */
  .marker-resource {
    position: absolute;
    transform: translate(-50%, -50%);
    z-index: 9;
    cursor: pointer;
  }
  .resource-icon {
    width: 20px; height: 20px;
    background: #2a1a00;
    border: 2px solid var(--yellow);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem;
    box-shadow: 0 0 8px rgba(255,214,0,0.3);
  }

  /* Tooltip */
  .tooltip {
    position: absolute;
    background: #0d180d;
    border: 1px solid var(--green);
    border-radius: 6px;
    padding: 8px 12px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.72rem;
    color: var(--green);
    z-index: 50;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
    white-space: nowrap;
    box-shadow: 0 0 16px rgba(57,255,20,0.15);
    transform: translate(-50%, -120%);
  }
  .tooltip.show { opacity: 1; }

  /* Destino marcador */
  .marker-dest {
    position: absolute;
    transform: translate(-50%, -100%);
    z-index: 11;
    display: none;
  }
  .marker-dest.show { display: block; }
  .dest-pin {
    width: 14px; height: 14px;
    background: var(--green);
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    margin: 0 auto;
    box-shadow: 0 0 10px var(--green);
  }
  .dest-label {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.6rem;
    color: var(--green);
    text-align: center;
    margin-top: 2px;
    white-space: nowrap;
  }

  /* Coordenadas esquina */
  .coords {
    position: absolute;
    bottom: 8px;
    left: 12px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.62rem;
    color: var(--muted);
    z-index: 10;
  }

  /* Leyenda mapa */
  .map-legend {
    position: absolute;
    bottom: 8px;
    right: 12px;
    background: rgba(5,9,5,0.85);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 8px 12px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.62rem;
    z-index: 10;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-dot { width: 8px; height: 8px; border-radius: 50%; }

  /* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
  .sidebar {
    width: 220px;
    background: var(--panel);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    flex-shrink: 0;
  }

  .sidebar-section {
    padding: 12px;
    border-bottom: 1px solid var(--border);
  }
  .sidebar-title {
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.65rem;
    color: var(--muted);
    letter-spacing: 2px;
    margin-bottom: 10px;
    text-transform: uppercase;
  }

  /* Botones de reporte */
  .report-btn {
    width: 100%;
    padding: 9px 10px;
    border-radius: 5px;
    border: 1px solid;
    background: transparent;
    cursor: pointer;
    font-family: 'Exo 2', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
    transition: all 0.2s;
    text-align: left;
  }
  .report-btn:last-child { margin-bottom: 0; }
  .btn-zombie  { color: var(--red);    border-color: #3a0a0a; }
  .btn-zombie:hover  { background: rgba(255,45,45,0.12);  border-color: var(--red); box-shadow: 0 0 8px rgba(255,45,45,0.2); }
  .btn-shelter { color: var(--green);  border-color: #0d2e0d; }
  .btn-shelter:hover { background: rgba(57,255,20,0.08);  border-color: var(--green); box-shadow: 0 0 8px rgba(57,255,20,0.15); }
  .btn-resource{ color: var(--yellow); border-color: #2a1a00; }
  .btn-resource:hover{ background: rgba(255,214,0,0.08);  border-color: var(--yellow); box-shadow: 0 0 8px rgba(255,214,0,0.15); }
  .btn-hostile { color: #ff8c00;       border-color: #2a1500; }
  .btn-hostile:hover { background: rgba(255,140,0,0.08);  border-color: #ff8c00; box-shadow: 0 0 8px rgba(255,140,0,0.15); }
  .btn-icon { font-size: 1rem; }
  .report-btn:active { transform: scale(0.97); }

  /* Feed de alertas */
  .alert-feed { display: flex; flex-direction: column; gap: 6px; }
  .alert-item {
    background: #080e08;
    border-left: 2px solid;
    border-radius: 0 4px 4px 0;
    padding: 6px 8px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.62rem;
    line-height: 1.4;
    animation: slideIn 0.3s ease;
  }
  @keyframes slideIn { from { opacity:0; transform: translateX(10px); } to { opacity:1; transform:none; } }
  .alert-red    { border-color: var(--red);    color: #ff9090; }
  .alert-green  { border-color: var(--green);  color: #90ff90; }
  .alert-yellow { border-color: var(--yellow); color: #ffe066; }
  .alert-orange { border-color: #ff8c00;       color: #ffb347; }
  .alert-time   { color: var(--muted); font-size: 0.58rem; display: block; margin-top: 2px; }

  /* Usuarios conectados */
  .mesh-nodes { display: flex; flex-direction: column; gap: 5px; }
  .node-item {
    display: flex; align-items: center; gap: 8px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.67rem;
    color: var(--text);
  }
  .node-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green); box-shadow: 0 0 4px var(--green); flex-shrink: 0; }
  .node-dist { margin-left: auto; color: var(--muted); font-size: 0.6rem; }

  /* Toast de notificacion */
  .toast {
    position: fixed;
    top: 60px;
    left: 50%;
    transform: translateX(-50%) translateY(-20px);
    background: #0d180d;
    border: 1px solid var(--green);
    border-radius: 6px;
    padding: 10px 20px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.78rem;
    color: var(--green);
    z-index: 200;
    opacity: 0;
    transition: all 0.3s;
    box-shadow: 0 0 20px rgba(57,255,20,0.2);
    white-space: nowrap;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
  .toast.red  { border-color: var(--red); color: var(--red); box-shadow: 0 0 20px rgba(255,45,45,0.2); }
  .toast.yellow { border-color: var(--yellow); color: var(--yellow); box-shadow: 0 0 20px rgba(255,214,0,0.2); }

  /* Alerta de horda */
  .horda-alert {
    position: absolute;
    top: 12px; left: 50%;
    transform: translateX(-50%);
    background: rgba(255,45,45,0.15);
    border: 1px solid var(--red);
    border-radius: 6px;
    padding: 6px 16px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.72rem;
    color: var(--red);
    z-index: 20;
    display: none;
    animation: blink 1s infinite;
    letter-spacing: 1px;
  }
  .horda-alert.show { display: block; }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.5} }

  /* Ruta badge */
  .route-badge {
    position: absolute;
    top: 12px; right: 12px;
    background: rgba(57,255,20,0.1);
    border: 1px solid var(--green);
    border-radius: 6px;
    padding: 6px 12px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 0.68rem;
    color: var(--green);
    z-index: 20;
    display: none;
  }
  .route-badge.show { display: block; }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: var(--panel); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="logo">‚¨° DEADMAP</div>
  <div class="search-bar">
    <span class="search-icon">‚åñ</span>
    <input type="text" id="searchInput" placeholder="¬øA d√≥nde quieres escapar hoy?" />
  </div>
  <button class="search-btn" onclick="runSearch()">RUTA</button>
  <div class="status-pills">
    <span class="pill pill-mesh">‚óè MESH ACTIVA</span>
    <span class="pill pill-users" id="userCount">‚¨° 47 NODOS</span>
  </div>
</div>

<!-- MAIN -->
<div class="main">

  <!-- MAPA -->
  <div class="map-container" id="mapContainer">
    <div class="map-grid"></div>
    <div class="map-grid-big"></div>

    <!-- Calles horizontales -->
    <div class="street street-h" style="top:20%"></div>
    <div class="street street-h" style="top:45%"></div>
    <div class="street street-h" style="top:70%"></div>
    <!-- Calles verticales -->
    <div class="street street-v" style="left:20%"></div>
    <div class="street street-v" style="left:50%"></div>
    <div class="street street-v" style="left:75%"></div>

    <!-- Zonas -->
    <div class="zone zone-red"    style="left:8%;  top:8%;  width:22%; height:22%;" onclick="zoneClick('ZONA ROJA','PELIGRO EXTREMO ‚Äî 40+ infectados detectados')">ZONA ROJA</div>
    <div class="zone zone-red"    style="left:55%; top:50%; width:20%; height:25%;" onclick="zoneClick('ZONA ROJA','PELIGRO ‚Äî Horda en movimiento')">ZONA ROJA</div>
    <div class="zone zone-yellow" style="left:30%; top:25%; width:18%; height:20%;" onclick="zoneClick('ZONA RIESGO','Actividad reportada ‚Äî Proceder con cautela')">RIESGO</div>
    <div class="zone zone-yellow" style="left:55%; top:8%;  width:16%; height:18%;" onclick="zoneClick('ZONA RIESGO','Grupos hostiles detectados al norte')">RIESGO</div>
    <div class="zone zone-green"  style="left:55%; top:25%; width:17%; height:20%;" onclick="zoneClick('ZONA SEGURA','Refugio verificado ‚Äî Capacidad: 120 personas')">SEGURA</div>
    <div class="zone zone-green"  style="left:8%;  top:55%; width:20%; height:22%;" onclick="zoneClick('ZONA SEGURA','Perimetro controlado ‚Äî Recursos disponibles')">SEGURA</div>

    <!-- SVG Ruta -->
    <svg class="route-svg" id="routeSvg">
      <path class="route-path" id="routePath" d="M 38% 80% L 38% 45% L 20% 45% L 20% 20% L 50% 20% L 50% 33%"/>
      <!-- flechita de destino -->
      <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
        <polygon points="0 0, 8 3, 0 6" fill="#39FF14"/>
      </marker>
    </svg>

    <!-- Zombie markers -->
    <div class="marker-zombie" style="left:15%; top:15%;" onclick="zombieClick(this, '18 infectados ¬∑ Mov: Sur ‚Üí')">
      <div class="zombie-arrow">‚Üì</div>
      <div class="zombie-dot"></div>
    </div>
    <div class="marker-zombie" style="left:65%; top:60%;" onclick="zombieClick(this, '32 infectados ¬∑ Mov: Oeste ‚Üê')">
      <div class="zombie-arrow">‚Üê</div>
      <div class="zombie-dot"></div>
    </div>
    <div class="marker-zombie" style="left:60%; top:12%;" onclick="zombieClick(this, '7 infectados ¬∑ Mov: Este ‚Üí')">
      <div class="zombie-arrow">‚Üí</div>
      <div class="zombie-dot"></div>
    </div>
    <div class="marker-zombie" style="left:40%; top:35%;" onclick="zombieClick(this, '11 infectados ¬∑ Mov: Norte ‚Üë')">
      <div class="zombie-arrow">‚Üë</div>
      <div class="zombie-dot"></div>
    </div>

    <!-- Shelter markers -->
    <div class="marker-shelter" style="left:64%; top:33%;" onclick="shelterClick('Refugio Centro ¬∑ Cap: 120 ¬∑ Estado: ABIERTO')">
      <div class="shelter-icon">‚õ∫</div>
    </div>
    <div class="marker-shelter" style="left:18%; top:65%;" onclick="shelterClick('Refugio Sur ¬∑ Cap: 80 ¬∑ Estado: ABIERTO')">
      <div class="shelter-icon">‚õ∫</div>
    </div>

    <!-- Resource markers -->
    <div class="marker-resource" style="left:22%; top:50%;" onclick="resourceClick('Suministros ¬∑ Agua + Comida ¬∑ Reportado hace 12min')">
      <div class="resource-icon">üéí</div>
    </div>
    <div class="marker-resource" style="left:50%; top:72%;" onclick="resourceClick('Combustible ¬∑ 2 veh√≠culos disponibles ¬∑ Reportado hace 34min')">
      <div class="resource-icon">‚õΩ</div>
    </div>

    <!-- Marcador usuario -->
    <div class="marker-user" style="left:38%; top:82%;"></div>

    <!-- Marcador destino -->
    <div class="marker-dest" id="destMarker" style="left:64%; top:33%;">
      <div class="dest-pin"></div>
      <div class="dest-label" id="destLabel">DESTINO</div>
    </div>

    <!-- Alerta horda -->
    <div class="horda-alert" id="hordaAlert">‚ö† HORDA DETECTADA ‚Äî REDIRIGIENDO RUTA</div>

    <!-- Badge ruta -->
    <div class="route-badge" id="routeBadge">üìç RUTA CALCULADA ¬∑ ~1.2 km ¬∑ ETA 18 min</div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <!-- Coordenadas -->
    <div class="coords" id="coordsDisplay">LAT 4.7109¬∞ N ¬∑ LNG -74.0721¬∞ W ¬∑ ALT 2600m</div>

    <!-- Leyenda -->
    <div class="map-legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--red)"></div> Zona infestada</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--yellow)"></div> Zona de riesgo</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--green)"></div> Zona segura</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--red); animation:pulse-zombie 1.5s infinite"></div> Horda activa</div>
      <div class="legend-item"><span style="font-size:0.65rem">‚õ∫</span> Refugio verificado</div>
      <div class="legend-item"><span style="font-size:0.65rem">üéí</span> Recursos</div>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar">

    <!-- Reportes rapidos -->
    <div class="sidebar-section">
      <div class="sidebar-title">‚¨° Reporte R√°pido</div>
      <button class="report-btn btn-zombie"   onclick="reportEvent('zombie')">  <span class="btn-icon">üßü</span> Zombis detectados</button>
      <button class="report-btn btn-shelter"  onclick="reportEvent('shelter')"> <span class="btn-icon">‚õ∫</span> Refugio seguro</button>
      <button class="report-btn btn-resource" onclick="reportEvent('resource')"><span class="btn-icon">üéí</span> Recursos disponibles</button>
      <button class="report-btn btn-hostile"  onclick="reportEvent('hostile')"> <span class="btn-icon">‚ö†</span> Grupo hostil</button>
    </div>

    <!-- Feed de alertas -->
    <div class="sidebar-section" style="flex:1">
      <div class="sidebar-title">‚¨° Alertas en Vivo</div>
      <div class="alert-feed" id="alertFeed">
        <div class="alert-item alert-red">üßü Horda ~32 mov. Oeste ‚Äî Av. 68<span class="alert-time">hace 2 min</span></div>
        <div class="alert-item alert-green">‚õ∫ Refugio Centro verificado ‚Äî 120 cupos<span class="alert-time">hace 5 min</span></div>
        <div class="alert-item alert-yellow">‚ö† Camino bloqueado ‚Äî Calle 80<span class="alert-time">hace 8 min</span></div>
        <div class="alert-item alert-orange">‚ö° Grupo hostil reportado ‚Äî Zona Norte<span class="alert-time">hace 11 min</span></div>
        <div class="alert-item alert-green">üéí Suministros disponibles ‚Äî Zona Sur<span class="alert-time">hace 15 min</span></div>
      </div>
    </div>

    <!-- Nodos mesh -->
    <div class="sidebar-section">
      <div class="sidebar-title">‚¨° Red Mesh Cercana</div>
      <div class="mesh-nodes">
        <div class="node-item"><div class="node-dot"></div> Usuario #A3F2 <span class="node-dist">120m</span></div>
        <div class="node-item"><div class="node-dot"></div> Usuario #B91C <span class="node-dist">280m</span></div>
        <div class="node-item"><div class="node-dot"></div> Usuario #D44E <span class="node-dist">410m</span></div>
        <div class="node-item"><div class="node-dot" style="background:#ffd600;box-shadow:0 0 4px #ffd600"></div> Usuario #F7A1 <span class="node-dist">590m</span></div>
      </div>
    </div>

  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
  // ‚îÄ‚îÄ SEARCH / RUTA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const destinations = {
    'aeropuerto': { label: 'AEROPUERTO', x: '64%', y: '33%', dist: '3.4 km', eta: '42 min' },
    'hospital':   { label: 'HOSPITAL',   x: '18%', y: '65%', dist: '1.8 km', eta: '22 min' },
    'estadio':    { label: 'ESTADIO',    x: '64%', y: '33%', dist: '2.1 km', eta: '28 min' },
    'norte':      { label: 'ZONA NORTE', x: '60%', y: '12%', dist: '4.2 km', eta: '55 min', danger: true },
    'sur':        { label: 'ZONA SUR',   x: '18%', y: '65%', dist: '1.2 km', eta: '18 min' },
  };

  function runSearch() {
    const val = document.getElementById('searchInput').value.trim().toLowerCase();
    let dest = null;
    for (const [key, d] of Object.entries(destinations)) {
      if (val.includes(key)) { dest = d; break; }
    }
    if (!dest) dest = { label: val.toUpperCase() || 'DESTINO', x: '64%', y: '33%', dist: '1.2 km', eta: '18 min' };

    const marker = document.getElementById('destMarker');
    const path   = document.getElementById('routePath');
    const badge  = document.getElementById('routeBadge');
    const horda  = document.getElementById('hordaAlert');

    marker.style.left  = dest.x;
    marker.style.top   = dest.y;
    document.getElementById('destLabel').textContent = dest.label;
    marker.classList.add('show');
    path.classList.add('visible');

    badge.textContent = `üìç RUTA CALCULADA ¬∑ ${dest.dist} ¬∑ ETA ${dest.eta}`;
    badge.classList.add('show');

    if (dest.danger) {
      horda.classList.add('show');
      showToast('‚ö† PELIGRO EN RUTA ‚Äî Zona Norte infestada', 'red');
      addAlert('alert-red', `‚ö† Ruta a ${dest.label} pasa por zona roja`);
    } else {
      horda.classList.remove('show');
      showToast(`‚úì Ruta a ${dest.label} calculada ‚Äî ${dest.dist}`, 'green');
      addAlert('alert-green', `üìç Ruta a ${dest.label} segura ‚Äî ${dest.dist}`);
    }
  }

  document.getElementById('searchInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') runSearch();
  });

  // ‚îÄ‚îÄ ZONE CLICK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function zoneClick(zona, msg) {
    const cls = zona.includes('ROJA') ? 'red' : zona.includes('RIESGO') ? 'yellow' : 'green';
    showToast(`${zona} ‚Äî ${msg}`, cls);
  }

  // ‚îÄ‚îÄ ZOMBIE CLICK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function zombieClick(el, info) {
    showToast(`üßü ${info}`, 'red');
    addAlert('alert-red', `üßü ${info}`);
  }

  // ‚îÄ‚îÄ SHELTER CLICK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function shelterClick(info) {
    showToast(`‚õ∫ ${info}`, 'green');
  }

  // ‚îÄ‚îÄ RESOURCE CLICK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function resourceClick(info) {
    showToast(`üéí ${info}`, 'yellow');
  }

  // ‚îÄ‚îÄ REPORT BUTTONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const reportMessages = {
    zombie:   { msg: 'üßü Zombis reportados ‚Äî Procesando ubicaci√≥n...', cls: 'red',    alert: 'alert-red',    txt: 'üßü Nuevo reporte: Zombis en tu ubicaci√≥n' },
    shelter:  { msg: '‚õ∫ Refugio reportado ‚Äî Enviando a validaci√≥n...', cls: 'green',  alert: 'alert-green',  txt: '‚õ∫ Nuevo refugio pendiente de validaci√≥n' },
    resource: { msg: 'üéí Recursos reportados ‚Äî Verificando con red...', cls: 'yellow', alert: 'alert-yellow', txt: 'üéí Nuevo reporte: Recursos disponibles' },
    hostile:  { msg: '‚ö† Grupo hostil reportado ‚Äî Alertando red...',    cls: 'red',    alert: 'alert-orange', txt: '‚ö† Alerta: Grupo hostil reportado cerca' },
  };

  function reportEvent(type) {
    const r = reportMessages[type];
    showToast(r.msg, r.cls);
    addAlert(r.alert, r.txt);
    // Incrementar nodos
    const el = document.getElementById('userCount');
    const n  = parseInt(el.textContent.match(/\d+/)[0]) + 1;
    el.textContent = `‚¨° ${n} NODOS`;
  }

  // ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  let toastTimer;
  function showToast(msg, cls = 'green') {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = `toast ${cls} show`;
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => t.classList.remove('show'), 3000);
  }

  // ‚îÄ‚îÄ ADD ALERT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function addAlert(cls, txt) {
    const feed = document.getElementById('alertFeed');
    const item = document.createElement('div');
    item.className = `alert-item ${cls}`;
    item.innerHTML = `${txt}<span class="alert-time">ahora</span>`;
    feed.insertBefore(item, feed.firstChild);
    if (feed.children.length > 8) feed.removeChild(feed.lastChild);
  }

  // ‚îÄ‚îÄ COORDS EN TIEMPO REAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  setInterval(() => {
    const lat = (4.7109 + (Math.random() - 0.5) * 0.0001).toFixed(4);
    const lng = (74.0721 + (Math.random() - 0.5) * 0.0001).toFixed(4);
    document.getElementById('coordsDisplay').textContent =
      `LAT ${lat}¬∞ N ¬∑ LNG -${lng}¬∞ W ¬∑ ALT 2600m`;
  }, 2000);

  // ‚îÄ‚îÄ ALERTAS AUTOMATICAS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const autoAlerts = [
    { cls: 'alert-red',    txt: 'üßü Movimiento detectado ‚Äî Zona Este' },
    { cls: 'alert-green',  txt: '‚úì Nodo #C22B conectado a la red mesh' },
    { cls: 'alert-yellow', txt: '‚ö† Ruta Calle 72 reportada como bloqueada' },
    { cls: 'alert-green',  txt: '‚õ∫ Refugio Norte confirma 45 cupos libres' },
    { cls: 'alert-orange', txt: '‚ö° Alerta: Disparo reportado ‚Äî Zona Industrial' },
  ];
  let autoIdx = 0;
  setInterval(() => {
    const a = autoAlerts[autoIdx % autoAlerts.length];
    addAlert(a.cls, a.txt);
    autoIdx++;
  }, 8000);
</script>
</body>
</html>
